"""
ì†Œìƒê³µì¸ì‹œì¥ì§„í¥ê³µë‹¨_ìƒê°€(ìƒê¶Œ)ì •ë³´_API ìƒì„¸ ë°ì´í„° êµ¬ì¡° ë¶„ì„
ì›¹ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‹¤ì œ ë°ì´í„° êµ¬ì¡° íŒŒì•… ë° í™œìš© ë°©ì•ˆ ë¶„ì„
"""

import pandas as pd
import json
from typing import Dict, List, Any

class BusinessAPIDetailedAnalyzer:
    def __init__(self):
        """ì›¹ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•œ ì‹¤ì œ ë°ì´í„° êµ¬ì¡°"""
        
        # ì‹¤ì œ APIì—ì„œ ì œê³µí•˜ëŠ” ì£¼ìš” ì»¬ëŸ¼ë“¤ (ì›¹ ê²€ìƒ‰ ê²°ê³¼ ê¸°ë°˜)
        self.expected_columns = {
            # ê¸°ë³¸ ì •ë³´
            "ìƒí˜¸ëª…": "ìƒê°€ì—…ì†Œì˜ ìƒí˜¸ëª…",
            "ì—…ì¢…ì½”ë“œ": "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ ê¸°ë°˜ ì—…ì¢…ì½”ë“œ (247ê°œ ì†Œë¶„ë¥˜)",
            "ì—…ì¢…ëª…": "ì—…ì¢…ëª… (ëŒ€ë¶„ë¥˜ 10ê°œ, ì¤‘ë¶„ë¥˜ 75ê°œ, ì†Œë¶„ë¥˜ 247ê°œ)",
            
            # ìœ„ì¹˜ ì •ë³´
            "ì§€ë²ˆì£¼ì†Œ": "ì§€ë²ˆ ê¸°ë°˜ ì£¼ì†Œ",
            "ë„ë¡œëª…ì£¼ì†Œ": "ë„ë¡œëª… ê¸°ë°˜ ì£¼ì†Œ", 
            "ê²½ë„": "ê²½ë„ ì¢Œí‘œ",
            "ìœ„ë„": "ìœ„ë„ ì¢Œí‘œ",
            
            # í–‰ì •êµ¬ì—­ ì •ë³´
            "ì‹œë„ëª…": "ì‹œ/ë„ ì •ë³´",
            "ì‹œêµ°êµ¬ëª…": "ì‹œ/êµ°/êµ¬ ì •ë³´", 
            "í–‰ì •ë™ëª…": "í–‰ì •ë™ ì •ë³´",
            
            # ì˜ì—… ì •ë³´
            "ìƒê°€ì—…ì†Œë²ˆí˜¸": "ìƒˆë¡­ê²Œ ìƒì„±ëœ ìƒê°€ì—…ì†Œ ê³ ìœ ë²ˆí˜¸",
            "ê°œì—…ì¼ì": "ê°œì—…ì¼ì (YYYYMMDD)",
            "íì—…ì¼ì": "íì—…ì¼ì (YYYYMMDD, ì˜ì—…ì¤‘ì´ë©´ ë¹ˆê°’)",
            "ì˜ì—…ìƒíƒœ": "ì˜ì—…/íì—… ìƒíƒœ",
            
            # ì¶”ê°€ ì •ë³´ (ìˆì„ ìˆ˜ ìˆëŠ” ì»¬ëŸ¼ë“¤)
            "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "10ì°¨ í‘œì¤€ì‚°ì—…ë¶„ë¥˜ ì½”ë“œ",
            "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ ì½”ë“œ",
            "ê±´ë¬¼ëª…": "ê±´ë¬¼ëª…",
            "ì¸µì •ë³´": "ì¸µ ì •ë³´",
            "í˜¸ì •ë³´": "í˜¸ ì •ë³´"
        }
        
        # ì—…ì¢… ë¶„ë¥˜ ì²´ê³„ (ì›¹ ê²€ìƒ‰ ê²°ê³¼ ê¸°ë°˜)
        self.industry_classification = {
            "ëŒ€ë¶„ë¥˜": 10,  # 10ê°œ ëŒ€ë¶„ë¥˜
            "ì¤‘ë¶„ë¥˜": 75,  # 75ê°œ ì¤‘ë¶„ë¥˜  
            "ì†Œë¶„ë¥˜": 247  # 247ê°œ ì†Œë¶„ë¥˜ (ê¸°ì¡´ 837ê°œì—ì„œ ê°œí¸)
        }
        
        # ë°ì´í„° ë³€ê²½ ì‚¬í•­ (2023ë…„ 4ì›”ë¶€í„° ì ìš©)
        self.data_changes = {
            "ë°ì´í„°_ìˆ˜ê¸‰ì²˜": "í–‰ì•ˆë¶€ ì¸í—ˆê°€ ë°ì´í„° â†’ êµ­ì„¸ì²­ ì‚¬ì—…ìë“±ë¡ì—…ì†Œ",
            "ìƒê¶Œì—…ì¢…ë¶„ë¥˜": "837ê°œ â†’ 247ê°œë¡œ ê°œí¸",
            "í‘œì¤€ì‚°ì—…ë¶„ë¥˜": "9ì°¨ â†’ 10ì°¨ ê°œí¸",
            "ìƒê°€ì—…ì†Œë²ˆí˜¸": "ìƒˆë¡­ê²Œ ìƒì„± (ê³¼ê±° ë°ì´í„°ì™€ ì—°ê³„ ë¶ˆê°€)",
            "API_ì„œë¹„ìŠ¤ëª…": "ë³€ê²½ë¨ (ì„œë¹„ìŠ¤ëŠ” ë™ì¼)"
        }
    
    def create_realistic_sample_data(self) -> pd.DataFrame:
        """ì‹¤ì œ API êµ¬ì¡°ë¥¼ ë°˜ì˜í•œ í˜„ì‹¤ì ì¸ ìƒ˜í”Œ ë°ì´í„° ìƒì„±"""
        
        sample_data = [
            {
                "ìƒê°€ì—…ì†Œë²ˆí˜¸": "11680100001",
                "ìƒí˜¸ëª…": "ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì—­ì ",
                "ì—…ì¢…ì½”ë“œ": "I56111",
                "ì—…ì¢…ëª…": "ì»¤í”¼ì „ë¬¸ì ",
                "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "56111",
                "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "CS100101",
                "ì§€ë²ˆì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45",
                "ë„ë¡œëª…ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
                "ê²½ë„": "127.0276",
                "ìœ„ë„": "37.4979",
                "ì‹œë„ëª…": "ì„œìš¸íŠ¹ë³„ì‹œ",
                "ì‹œêµ°êµ¬ëª…": "ê°•ë‚¨êµ¬",
                "í–‰ì •ë™ëª…": "ì—­ì‚¼ë™",
                "ê±´ë¬¼ëª…": "ê°•ë‚¨ë¹Œë”©",
                "ì¸µì •ë³´": "1ì¸µ",
                "í˜¸ì •ë³´": "101í˜¸",
                "ê°œì—…ì¼ì": "20230315",
                "íì—…ì¼ì": "",
                "ì˜ì—…ìƒíƒœ": "ì˜ì—…"
            },
            {
                "ìƒê°€ì—…ì†Œë²ˆí˜¸": "11680100002", 
                "ìƒí˜¸ëª…": "ë§›ìˆëŠ” í•œì‹ë‹¹",
                "ì—…ì¢…ì½”ë“œ": "I56211",
                "ì—…ì¢…ëª…": "í•œì‹ìŒì‹ì ",
                "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "56211",
                "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "RS100101",
                "ì§€ë²ˆì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-47",
                "ë„ë¡œëª…ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 125",
                "ê²½ë„": "127.0278",
                "ìœ„ë„": "37.4981",
                "ì‹œë„ëª…": "ì„œìš¸íŠ¹ë³„ì‹œ",
                "ì‹œêµ°êµ¬ëª…": "ê°•ë‚¨êµ¬",
                "í–‰ì •ë™ëª…": "ì—­ì‚¼ë™",
                "ê±´ë¬¼ëª…": "ì—­ì‚¼íƒ€ì›Œ",
                "ì¸µì •ë³´": "ì§€í•˜1ì¸µ",
                "í˜¸ì •ë³´": "B101í˜¸",
                "ê°œì—…ì¼ì": "20220801",
                "íì—…ì¼ì": "",
                "ì˜ì—…ìƒíƒœ": "ì˜ì—…"
            },
            {
                "ìƒê°€ì—…ì†Œë²ˆí˜¸": "11680100003",
                "ìƒí˜¸ëª…": "GS25 í…Œí—¤ë€ì ",
                "ì—…ì¢…ì½”ë“œ": "G47111",
                "ì—…ì¢…ëª…": "í¸ì˜ì ",
                "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "47111",
                "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "RT100101",
                "ì§€ë²ˆì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-49",
                "ë„ë¡œëª…ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 127",
                "ê²½ë„": "127.0280",
                "ìœ„ë„": "37.4983",
                "ì‹œë„ëª…": "ì„œìš¸íŠ¹ë³„ì‹œ",
                "ì‹œêµ°êµ¬ëª…": "ê°•ë‚¨êµ¬",
                "í–‰ì •ë™ëª…": "ì—­ì‚¼ë™",
                "ê±´ë¬¼ëª…": "",
                "ì¸µì •ë³´": "1ì¸µ",
                "í˜¸ì •ë³´": "",
                "ê°œì—…ì¼ì": "20210601",
                "íì—…ì¼ì": "",
                "ì˜ì—…ìƒíƒœ": "ì˜ì—…"
            },
            {
                "ìƒê°€ì—…ì†Œë²ˆí˜¸": "11680100004",
                "ìƒí˜¸ëª…": "í—¤ì–´ìƒµ ë·°í‹°",
                "ì—…ì¢…ì½”ë“œ": "S96121",
                "ì—…ì¢…ëª…": "ë¯¸ìš©ì—…",
                "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "96121",
                "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "PS100101",
                "ì§€ë²ˆì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-51",
                "ë„ë¡œëª…ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 129",
                "ê²½ë„": "127.0282",
                "ìœ„ë„": "37.4985",
                "ì‹œë„ëª…": "ì„œìš¸íŠ¹ë³„ì‹œ",
                "ì‹œêµ°êµ¬ëª…": "ê°•ë‚¨êµ¬",
                "í–‰ì •ë™ëª…": "ì—­ì‚¼ë™",
                "ê±´ë¬¼ëª…": "ë·°í‹°í”Œë¼ì",
                "ì¸µì •ë³´": "2ì¸µ",
                "í˜¸ì •ë³´": "201í˜¸",
                "ê°œì—…ì¼ì": "20200315",
                "íì—…ì¼ì": "20231201",
                "ì˜ì—…ìƒíƒœ": "íì—…"
            },
            {
                "ìƒê°€ì—…ì†Œë²ˆí˜¸": "11680100005",
                "ìƒí˜¸ëª…": "ì•½êµ­ ê±´ê°•",
                "ì—…ì¢…ì½”ë“œ": "G47731",
                "ì—…ì¢…ëª…": "ì˜ì•½í’ˆì†Œë§¤ì—…",
                "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ì½”ë“œ": "47731",
                "ìƒê¶Œì—…ì¢…ë¶„ë¥˜ì½”ë“œ": "RT200101",
                "ì§€ë²ˆì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-53",
                "ë„ë¡œëª…ì£¼ì†Œ": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 131",
                "ê²½ë„": "127.0284",
                "ìœ„ë„": "37.4987",
                "ì‹œë„ëª…": "ì„œìš¸íŠ¹ë³„ì‹œ",
                "ì‹œêµ°êµ¬ëª…": "ê°•ë‚¨êµ¬",
                "í–‰ì •ë™ëª…": "ì—­ì‚¼ë™",
                "ê±´ë¬¼ëª…": "ë©”ë””ì»¬ì„¼í„°",
                "ì¸µì •ë³´": "1ì¸µ",
                "í˜¸ì •ë³´": "102í˜¸",
                "ê°œì—…ì¼ì": "20190801",
                "íì—…ì¼ì": "",
                "ì˜ì—…ìƒíƒœ": "ì˜ì—…"
            }
        ]
        
        return pd.DataFrame(sample_data)
    
    def analyze_business_potential(self, df: pd.DataFrame) -> Dict[str, Any]:
        """ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ê°€ëŠ¥ì„± ë¶„ì„"""
        
        analysis = {
            "ë°ì´í„°_í’ˆì§ˆ": {
                "ì´_ë ˆì½”ë“œìˆ˜": len(df),
                "ìœ„ì¹˜ì •ë³´_ì™„ì„±ë„": {
                    "ê²½ë„ìœ„ë„_ìˆìŒ": len(df[df['ê²½ë„'].notna() & df['ìœ„ë„'].notna()]),
                    "ë„ë¡œëª…ì£¼ì†Œ_ìˆìŒ": len(df[df['ë„ë¡œëª…ì£¼ì†Œ'].notna()]),
                    "ì§€ë²ˆì£¼ì†Œ_ìˆìŒ": len(df[df['ì§€ë²ˆì£¼ì†Œ'].notna()])
                },
                "ì˜ì—…ìƒíƒœ_ë¶„í¬": df['ì˜ì—…ìƒíƒœ'].value_counts().to_dict()
            },
            
            "ì—…ì¢…_ë¶„ì„": {
                "ì—…ì¢…_ë‹¤ì–‘ì„±": df['ì—…ì¢…ëª…'].nunique(),
                "ì£¼ìš”_ì—…ì¢…": df['ì—…ì¢…ëª…'].value_counts().head(5).to_dict(),
                "ì—…ì¢…ì½”ë“œ_ì²´ê³„": "í‘œì¤€ì‚°ì—…ë¶„ë¥˜ 10ì°¨ ê¸°ë°˜"
            },
            
            "ì§€ì—­_ë¶„ì„": {
                "ì‹œë„_ë¶„í¬": df['ì‹œë„ëª…'].value_counts().to_dict(),
                "ì‹œêµ°êµ¬_ë¶„í¬": df['ì‹œêµ°êµ¬ëª…'].value_counts().to_dict(),
                "í–‰ì •ë™_ë¶„í¬": df['í–‰ì •ë™ëª…'].value_counts().to_dict()
            },
            
            "ì‹œê°„_ë¶„ì„": {
                "ê°œì—…ë…„ë„_ë¶„í¬": df['ê°œì—…ì¼ì'].str[:4].value_counts().to_dict(),
                "íì—…_ë¹„ìœ¨": len(df[df['ì˜ì—…ìƒíƒœ'] == 'íì—…']) / len(df) * 100
            }
        }
        
        return analysis
    
    def suggest_leaflet_integration(self) -> Dict[str, Any]:
        """Leaflet ì§€ë„ ì—°ë™ ë°©ì•ˆ ì œì•ˆ"""
        
        integration_plan = {
            "í•µì‹¬_ê¸°ëŠ¥": {
                "1_ê¸°ë³¸_ë§ˆì»¤_í‘œì‹œ": {
                    "ì„¤ëª…": "ì‚¬ìš©ì ì„ íƒ ìœ„ì¹˜ ì£¼ë³€ ìƒê°€ë“¤ì„ ì§€ë„ì— ë§ˆì»¤ë¡œ í‘œì‹œ",
                    "ë°ì´í„°": ["ê²½ë„", "ìœ„ë„", "ìƒí˜¸ëª…", "ì—…ì¢…ëª…"],
                    "êµ¬í˜„_ë‚œì´ë„": "ì‰¬ì›€",
                    "ì‹œê°ì _ì„íŒ©íŠ¸": "ë†’ìŒ"
                },
                
                "2_ì—…ì¢…ë³„_ìƒ‰ìƒ_êµ¬ë¶„": {
                    "ì„¤ëª…": "ì—…ì¢…ì— ë”°ë¼ ë‹¤ë¥¸ ìƒ‰ìƒ/ì•„ì´ì½˜ìœ¼ë¡œ ë§ˆì»¤ í‘œì‹œ",
                    "ë°ì´í„°": ["ì—…ì¢…ì½”ë“œ", "ì—…ì¢…ëª…"],
                    "êµ¬í˜„_ë‚œì´ë„": "ë³´í†µ",
                    "ì‹œê°ì _ì„íŒ©íŠ¸": "ë§¤ìš°ë†’ìŒ"
                },
                
                "3_ìƒê°€ì •ë³´_íŒì—…": {
                    "ì„¤ëª…": "ë§ˆì»¤ í´ë¦­ ì‹œ ìƒê°€ ìƒì„¸ì •ë³´ íŒì—… í‘œì‹œ",
                    "ë°ì´í„°": ["ìƒí˜¸ëª…", "ì—…ì¢…ëª…", "ë„ë¡œëª…ì£¼ì†Œ", "ê°œì—…ì¼ì", "ì˜ì—…ìƒíƒœ"],
                    "êµ¬í˜„_ë‚œì´ë„": "ì‰¬ì›€",
                    "ì‹¤ìš©ì„±": "ë†’ìŒ"
                },
                
                "4_ê²½ìŸì—…ì²´_í•„í„°ë§": {
                    "ì„¤ëª…": "ì‚¬ìš©ì ì—…ì¢…ê³¼ ë™ì¼í•œ ìƒê°€ë§Œ í•„í„°ë§í•˜ì—¬ í‘œì‹œ",
                    "ë°ì´í„°": ["ì—…ì¢…ì½”ë“œ", "ì—…ì¢…ëª…"],
                    "êµ¬í˜„_ë‚œì´ë„": "ë³´í†µ",
                    "ë¹„ì¦ˆë‹ˆìŠ¤_ê°€ì¹˜": "ë§¤ìš°ë†’ìŒ"
                }
            },
            
            "ê³ ê¸‰_ê¸°ëŠ¥": {
                "1_ìƒê¶Œ_ë°€ë„_íˆíŠ¸ë§µ": {
                    "ì„¤ëª…": "ìƒê°€ ë°€ì§‘ë„ë¥¼ íˆíŠ¸ë§µìœ¼ë¡œ ì‹œê°í™”",
                    "ê¸°ìˆ ": "Leaflet.heat í”ŒëŸ¬ê·¸ì¸",
                    "êµ¬í˜„_ë‚œì´ë„": "ì–´ë ¤ì›€",
                    "ì„íŒ©íŠ¸": "ë§¤ìš°ë†’ìŒ"
                },
                
                "2_ë°˜ê²½ë³„_í†µê³„": {
                    "ì„¤ëª…": "ì„ íƒ ìœ„ì¹˜ ê¸°ì¤€ ë°˜ê²½ 500m, 1km ë‚´ ìƒê°€ í†µê³„",
                    "ë°ì´í„°": ["ê²½ë„", "ìœ„ë„", "ì—…ì¢…ëª…"],
                    "êµ¬í˜„_ë‚œì´ë„": "ë³´í†µ",
                    "ì‹¤ìš©ì„±": "ë†’ìŒ"
                },
                
                "3_ê°œíì—…_íŠ¸ë Œë“œ": {
                    "ì„¤ëª…": "ìµœê·¼ ê°œì—…/íì—… ìƒê°€ ì •ë³´ í‘œì‹œ",
                    "ë°ì´í„°": ["ê°œì—…ì¼ì", "íì—…ì¼ì", "ì˜ì—…ìƒíƒœ"],
                    "êµ¬í˜„_ë‚œì´ë„": "ë³´í†µ",
                    "ë¹„ì¦ˆë‹ˆìŠ¤_ê°€ì¹˜": "ë†’ìŒ"
                }
            },
            
            "API_í˜¸ì¶œ_ì „ëµ": {
                "ì§€ì—­_ê¸°ë°˜_í˜¸ì¶œ": "ì‚¬ìš©ì ì„ íƒ ìœ„ì¹˜ì˜ ì‹œêµ°êµ¬ ê¸°ì¤€ìœ¼ë¡œ API í˜¸ì¶œ",
                "í˜ì´ì§•_ì²˜ë¦¬": "ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ í˜ì´ì§•",
                "ìºì‹±_ì „ëµ": "ë™ì¼ ì§€ì—­ ì¬ìš”ì²­ ì‹œ ìºì‹œ í™œìš©",
                "ì—ëŸ¬_ì²˜ë¦¬": "API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ìƒ˜í”Œ ë°ì´í„° í™œìš©"
            }
        }
        
        return integration_plan
    
    def create_business_use_cases(self) -> Dict[str, Any]:
        """ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ì‚¬ë¡€ ì œì•ˆ"""
        
        use_cases = {
            "ì°½ì—…_ìœ„ì¹˜_ë¶„ì„": {
                "ì‹œë‚˜ë¦¬ì˜¤": "ì¹´í˜ ì°½ì—…ì„ ì›í•˜ëŠ” ì‚¬ìš©ìê°€ ê°•ë‚¨ì—­ ê·¼ì²˜ ìœ„ì¹˜ ì„ íƒ",
                "ì œê³µ_ì •ë³´": [
                    "ë°˜ê²½ 500m ë‚´ ì»¤í”¼ì „ë¬¸ì  15ê°œ ìœ„ì¹˜ í‘œì‹œ",
                    "ê²½ìŸ ë°€ë„: ë†’ìŒ (í‰ê·  ëŒ€ë¹„ 200%)",
                    "ì¶”ì²œ: ì—­ì‚¼ë™ë³´ë‹¤ ë…¼í˜„ë™ ìª½ì´ ê²½ìŸì´ ì ìŒ"
                ],
                "AI_ì—°ê³„": "ìƒê¶Œ íŠ¹ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ë§ˆì¼€íŒ… ì „ëµ ì œì•ˆ"
            },
            
            "ìƒê¶Œ_íŠ¹ì„±_ë¶„ì„": {
                "ì‹œë‚˜ë¦¬ì˜¤": "ì„ íƒí•œ ìœ„ì¹˜ì˜ ìƒê¶Œ íŠ¹ì„± íŒŒì•…",
                "ì œê³µ_ì •ë³´": [
                    "ì£¼ìš” ì—…ì¢…: ìŒì‹ì (35%), ì†Œë§¤ì—…(25%), ì„œë¹„ìŠ¤ì—…(20%)",
                    "ìƒê¶Œ ìœ í˜•: ì˜¤í”¼ìŠ¤ ë°€ì§‘ ì§€ì—­",
                    "íƒ€ê²Ÿ ê³ ê°ì¸µ: ì§ì¥ì¸ ì¤‘ì‹¬"
                ],
                "ë§ˆì¼€íŒ…_ì—°ê³„": "ì ì‹¬ì‹œê°„ íƒ€ê²Ÿ ë§ˆì¼€íŒ… ì½˜í…ì¸  ìƒì„±"
            },
            
            "ê²½ìŸ_í˜„í™©_ë¶„ì„": {
                "ì‹œë‚˜ë¦¬ì˜¤": "ë™ì¼ ì—…ì¢… ê²½ìŸì—…ì²´ í˜„í™© íŒŒì•…",
                "ì œê³µ_ì •ë³´": [
                    "ë™ì¼ ì—…ì¢… ìƒê°€ ìœ„ì¹˜ ë° ê°œì—…ì¼ì",
                    "ìµœê·¼ 1ë…„ê°„ ì‹ ê·œ ê°œì—…: 3ê°œ",
                    "íì—…ë¥ : ì—…ì¢… í‰ê·  ëŒ€ë¹„ ë‚®ìŒ"
                ],
                "ì¸ì‚¬ì´íŠ¸": "ì‹œì¥ í¬í™”ë„ ë° ì§„ì… ê°€ëŠ¥ì„± í‰ê°€"
            }
        }
        
        return use_cases
    
    def generate_implementation_roadmap(self) -> Dict[str, Any]:
        """êµ¬í˜„ ë¡œë“œë§µ ì œì•ˆ"""
        
        roadmap = {
            "1ë‹¨ê³„_ê¸°ë³¸êµ¬í˜„": {
                "ê¸°ê°„": "1-2ì¼",
                "ì‘ì—…": [
                    "API í˜¸ì¶œ ë° ë°ì´í„° íŒŒì‹± êµ¬í˜„",
                    "Leaflet ì§€ë„ì— ê¸°ë³¸ ë§ˆì»¤ í‘œì‹œ",
                    "ìƒê°€ ì •ë³´ íŒì—… êµ¬í˜„"
                ],
                "ê²°ê³¼": "ê¸°ë³¸ì ì¸ ìƒê°€ ìœ„ì¹˜ ì‹œê°í™”"
            },
            
            "2ë‹¨ê³„_ê¸°ëŠ¥ê°•í™”": {
                "ê¸°ê°„": "2-3ì¼", 
                "ì‘ì—…": [
                    "ì—…ì¢…ë³„ ë§ˆì»¤ ìƒ‰ìƒ/ì•„ì´ì½˜ êµ¬ë¶„",
                    "ê²½ìŸì—…ì²´ í•„í„°ë§ ê¸°ëŠ¥",
                    "ë°˜ê²½ë³„ ìƒê°€ í†µê³„ í‘œì‹œ"
                ],
                "ê²°ê³¼": "ì‹¤ìš©ì ì¸ ìƒê¶Œ ë¶„ì„ ë„êµ¬"
            },
            
            "3ë‹¨ê³„_ê³ ë„í™”": {
                "ê¸°ê°„": "3-5ì¼",
                "ì‘ì—…": [
                    "ìƒê¶Œ ë°€ë„ íˆíŠ¸ë§µ",
                    "AI ê¸°ë°˜ ì¸ì‚¬ì´íŠ¸ ìƒì„±",
                    "ë§ˆì¼€íŒ… ì½˜í…ì¸  ì—°ê³„"
                ],
                "ê²°ê³¼": "ì™„ì„±ë„ ë†’ì€ ì°½ì—… ì§€ì› ì‹œìŠ¤í…œ"
            }
        }
        
        return roadmap

def main():
    """ë©”ì¸ ë¶„ì„ ì‹¤í–‰"""
    print("ğŸª ì†Œìƒê³µì¸ì‹œì¥ì§„í¥ê³µë‹¨ ìƒê°€ì •ë³´ API ìƒì„¸ ë¶„ì„")
    print("="*60)
    
    analyzer = BusinessAPIDetailedAnalyzer()
    
    # 1. í˜„ì‹¤ì ì¸ ìƒ˜í”Œ ë°ì´í„° ìƒì„±
    print("\nğŸ“Š í˜„ì‹¤ì ì¸ ìƒ˜í”Œ ë°ì´í„° ìƒì„±...")
    df = analyzer.create_realistic_sample_data()
    print(f"âœ… ìƒ˜í”Œ ë°ì´í„° ìƒì„± ì™„ë£Œ: {len(df)}í–‰ Ã— {len(df.columns)}ì—´")
    
    # 2. ë°ì´í„° êµ¬ì¡° ì¶œë ¥
    print(f"\nğŸ“‹ ë°ì´í„° ì»¬ëŸ¼ ì •ë³´:")
    for i, col in enumerate(df.columns):
        print(f"   {i+1:2d}. {col}")
    
    # 3. ìƒ˜í”Œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°
    print(f"\nğŸ“ ìƒ˜í”Œ ë°ì´í„° ë¯¸ë¦¬ë³´ê¸°:")
    print(df[['ìƒí˜¸ëª…', 'ì—…ì¢…ëª…', 'ë„ë¡œëª…ì£¼ì†Œ', 'ì˜ì—…ìƒíƒœ']].to_string())
    
    # 4. ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ê°€ëŠ¥ì„± ë¶„ì„
    print(f"\nğŸ¯ ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ê°€ëŠ¥ì„± ë¶„ì„...")
    business_analysis = analyzer.analyze_business_potential(df)
    print(f"   - ìœ„ì¹˜ì •ë³´ ì™„ì„±ë„: {business_analysis['ë°ì´í„°_í’ˆì§ˆ']['ìœ„ì¹˜ì •ë³´_ì™„ì„±ë„']}")
    print(f"   - ì—…ì¢… ë‹¤ì–‘ì„±: {business_analysis['ì—…ì¢…_ë¶„ì„']['ì—…ì¢…_ë‹¤ì–‘ì„±']}ê°œ ì—…ì¢…")
    print(f"   - ì˜ì—…ìƒíƒœ ë¶„í¬: {business_analysis['ë°ì´í„°_í’ˆì§ˆ']['ì˜ì—…ìƒíƒœ_ë¶„í¬']}")
    
    # 5. Leaflet ì—°ë™ ë°©ì•ˆ
    print(f"\nğŸ—ºï¸ Leaflet ì§€ë„ ì—°ë™ ë°©ì•ˆ...")
    integration_plan = analyzer.suggest_leaflet_integration()
    print(f"   í•µì‹¬ ê¸°ëŠ¥ {len(integration_plan['í•µì‹¬_ê¸°ëŠ¥'])}ê°œ, ê³ ê¸‰ ê¸°ëŠ¥ {len(integration_plan['ê³ ê¸‰_ê¸°ëŠ¥'])}ê°œ ì œì•ˆ")
    
    # 6. ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ì‚¬ë¡€
    print(f"\nğŸ’¼ ë¹„ì¦ˆë‹ˆìŠ¤ í™œìš© ì‚¬ë¡€...")
    use_cases = analyzer.create_business_use_cases()
    for case_name, case_info in use_cases.items():
        print(f"   - {case_name}: {case_info['ì‹œë‚˜ë¦¬ì˜¤']}")
    
    # 7. êµ¬í˜„ ë¡œë“œë§µ
    print(f"\nğŸ›£ï¸ êµ¬í˜„ ë¡œë“œë§µ...")
    roadmap = analyzer.generate_implementation_roadmap()
    for phase, info in roadmap.items():
        print(f"   - {phase}: {info['ê¸°ê°„']} ({info['ê²°ê³¼']})")
    
    # 8. ê²°ê³¼ ì €ì¥
    analysis_result = {
        "sample_data": df.to_dict('records'),
        "business_analysis": business_analysis,
        "integration_plan": integration_plan,
        "use_cases": use_cases,
        "roadmap": roadmap,
        "expected_columns": analyzer.expected_columns,
        "data_changes": analyzer.data_changes
    }
    
    with open('business_api_detailed_analysis.json', 'w', encoding='utf-8') as f:
        json.dump(analysis_result, f, ensure_ascii=False, indent=2)
    
    print(f"\nğŸ’¾ ìƒì„¸ ë¶„ì„ ê²°ê³¼ê°€ 'business_api_detailed_analysis.json'ì— ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")
    
    print("\n" + "="*60)
    print("ğŸ¯ ê²°ë¡  ë° ì¶”ì²œì‚¬í•­:")
    print("1. âœ… ì§€ë„ ì—°ë™ ê°€ëŠ¥ì„±: ë§¤ìš° ë†’ìŒ (ê²½ë„/ìœ„ë„ ë°ì´í„° ì™„ë¹„)")
    print("2. âœ… ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜: ë†’ìŒ (ì°½ì—… ìœ„ì¹˜ ë¶„ì„, ê²½ìŸ í˜„í™© íŒŒì•…)")
    print("3. âœ… êµ¬í˜„ ë‚œì´ë„: ë³´í†µ (ê¸°ì¡´ Leaflet ì§€ë„ í™œìš© ê°€ëŠ¥)")
    print("4. âœ… ë°œí‘œ ì„íŒ©íŠ¸: ë§¤ìš° ë†’ìŒ (êµ­ê°€ ê³µê³µë°ì´í„° + AI ìœµí•©)")
    print("5. ğŸš€ ì¶”ì²œ: 1ë‹¨ê³„ ê¸°ë³¸ êµ¬í˜„ë¶€í„° ì‹œì‘í•˜ì—¬ ë‹¨ê³„ì  ê³ ë„í™”")
    print("="*60)
    
    return df, analysis_result

if __name__ == "__main__":
    df, analysis = main() 